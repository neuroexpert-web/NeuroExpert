<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç AI –º–æ–¥–µ–ª–µ–π NeuroExpert</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .model-test {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .model-test h3 {
            margin-top: 0;
            color: #333;
        }
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            display: inline-block;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.loading { background: #cce5ff; color: #004085; }
        .response {
            margin-top: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            white-space: pre-wrap;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç AI –º–æ–¥–µ–ª–µ–π NeuroExpert</h1>
    
    <div class="test-container">
        <h2>–°—Ç–∞—Ç—É—Å API</h2>
        <div id="api-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>
    </div>

    <div class="test-container">
        <h2>–¢–µ—Å—Ç –º–æ–¥–µ–ª–µ–π</h2>
        <button onclick="testAllModels()">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–æ–¥–µ–ª–∏</button>
        
        <div id="models-tests">
            <div class="model-test" id="gemini-test">
                <h3>Google Gemini</h3>
                <div class="status loading">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
                <div class="response"></div>
            </div>
            
            <div class="model-test" id="gpt4-test">
                <h3>GPT-4 (OpenRouter)</h3>
                <div class="status loading">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
                <div class="response"></div>
            </div>
            
            <div class="model-test" id="claude-test">
                <h3>Claude 3</h3>
                <div class="status loading">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
                <div class="response"></div>
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ API
        async function checkAPIStatus() {
            try {
                const response = await fetch('/api/assistant', { method: 'GET' });
                const data = await response.json();
                
                const statusDiv = document.getElementById('api-status');
                statusDiv.innerHTML = `
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${data.success ? '‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç' : '‚ùå API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç'}</p>
                    <p><strong>Gemini –∫–ª—é—á:</strong> ${data.env?.hasGeminiKey ? '‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' : '‚ùå –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</p>
                    <p><strong>OpenRouter –∫–ª—é—á:</strong> ${data.env?.hasOpenRouterKey ? '‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' : '‚ùå –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</p>
                    <p><strong>Anthropic –∫–ª—é—á:</strong> ${data.env?.hasAnthropicKey ? '‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω' : '‚ùå –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</p>
                `;
            } catch (error) {
                document.getElementById('api-status').innerHTML = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ API: ' + error.message;
            }
        }

        // –¢–µ—Å—Ç –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏
        async function testModel(modelId, modelName) {
            const testDiv = document.getElementById(`${modelId}-test`);
            const statusDiv = testDiv.querySelector('.status');
            const responseDiv = testDiv.querySelector('.response');
            
            statusDiv.className = 'status loading';
            statusDiv.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...';
            responseDiv.textContent = '';
            
            try {
                const response = await fetch('/api/assistant', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: '–ü—Ä–∏–≤–µ—Ç! –†–∞—Å—Å–∫–∞–∂–∏ –∫—Ä–∞—Ç–∫–æ, –∫–∞–∫–∞—è —Ç—ã AI –º–æ–¥–µ–ª—å –∏ —á—Ç–æ —É–º–µ–µ—à—å –¥–µ–ª–∞—Ç—å?',
                        model: modelName,
                        context: 'general'
                    })
                });
                
                const data = await response.json();
                
                if (data.success || data.response || data.reply) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç';
                    responseDiv.textContent = data.response || data.reply || data.answer || '–û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω';
                    responseDiv.innerHTML += `\n\n<small>–ú–æ–¥–µ–ª—å: ${data.model || modelName}</small>`;
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '‚ùå –û—à–∏–±–∫–∞';
                    responseDiv.textContent = data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏';
                responseDiv.textContent = error.message;
            }
        }

        // –¢–µ—Å—Ç –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
        async function testAllModels() {
            await testModel('gemini', 'gemini');
            await testModel('gpt4', 'gpt-4');
            await testModel('claude', 'claude');
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            checkAPIStatus();
        };
    </script>
</body>
</html>